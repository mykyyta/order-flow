{% extends "base.html" %}
{% load order_ui %}
{% load tz %}

{% block title %}–î–µ—Ç–∞–ª—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è{% endblock %}

{% block content %}

{% include "partials/messages.html" %}

<div class="card">
    {% include "partials/card_section_header.html" with title="–î–µ—Ç–∞–ª—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è" edit_url=order_edit_url %}
    <div class="detail-card-body">
        <dl class="min-w-0">
            <div class="detail-group">
                <dt class="detail-group-title" aria-hidden="true">–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è</dt>
                <dd class="sr-only">–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è</dd>
                <div class="detail-row">
                    <dt class="detail-dt">–ú–æ–¥–µ–ª—å ¬∑ –ö–æ–ª—ñ—Ä</dt>
                    <dd class="detail-hero">{{ order.model }} ¬∑ {{ order.color }}</dd>
                </div>
                <div class="detail-row">
                    <dt class="detail-dt">–í–∏—à–∏–≤–∫–∞</dt>
                    <dd class="detail-dd">{% if order.embroidery %}<span class="inline-block text-[1rem] leading-none" title="–í–∏—à–∏–≤–∫–∞" aria-hidden="true">üë®üèª‚Äçü¶≥</span> –¢–∞–∫{% else %}‚Äî{% endif %}</dd>
                </div>
                <div class="detail-row">
                    <dt class="detail-dt">Etsy</dt>
                    <dd class="detail-dd">{% if order.etsy %}<span class="inline-block text-[1rem] leading-none" title="Etsy" aria-hidden="true">üåç</span> –¢–∞–∫{% else %}‚Äî{% endif %}</dd>
                </div>
                <div class="detail-row">
                    <dt class="detail-dt">–¢–µ—Ä–º—ñ–Ω–æ–≤–æ</dt>
                    <dd class="detail-dd">{% if order.urgent %}<span class="inline-block text-[1rem] leading-none" title="–¢–µ—Ä–º—ñ–Ω–æ–≤–æ" aria-hidden="true">‚ö°</span> –¢–∞–∫{% else %}‚Äî{% endif %}</dd>
                </div>
                <div class="detail-row">
                    <dt class="detail-dt">–ö–æ–º–µ–Ω—Ç–∞—Ä</dt>
                    <dd class="detail-dd">{{ order.comment|default:"‚Äî" }}</dd>
                </div>
            </div>
        </dl>
        <dl class="min-w-0 md:border-l md:border-slate-100 md:pl-8">
            <div class="detail-group">
                <dt class="detail-group-title" aria-hidden="true">–î–∞—Ç–∏</dt>
                <dd class="sr-only">–î–∞—Ç–∏</dd>
                <div class="detail-row">
                    <dt class="detail-dt">–°—Ç–≤–æ—Ä–µ–Ω–æ</dt>
                    <dd class="detail-dd">{{ order.created_at|date:"d.m.Y H:i" }}</dd>
                </div>
                <div class="detail-row">
                    <dt class="detail-dt">–ó–∞–∫—ñ–Ω—á–µ–Ω–æ</dt>
                    <dd class="detail-dd">{% if order.finished_at %}{{ order.finished_at|date:"d.m.Y H:i" }}{% else %}‚Äî{% endif %}</dd>
                </div>
            </div>
            <div class="detail-group">
                <dt class="detail-group-title" aria-hidden="true">–°—Ç–∞—Ç—É—Å</dt>
                <dd class="sr-only">–°—Ç–∞—Ç—É—Å</dd>
                <div class="detail-row">
                    <dt class="detail-dt">–ü–æ—Ç–æ—á–Ω–∏–π</dt>
                    <dd>
                        {% status_indicator order.current_status_code order.current_status_display %}
                    </dd>
                </div>
            </div>
        </dl>
    </div>
</div>

<div class="card mt-6">
    {% include "partials/card_section_header.html" with title="–Ü—Å—Ç–æ—Ä—ñ—è —Å—Ç–∞—Ç—É—Å—ñ–≤" %}
    <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-slate-200">
            <thead class="bg-slate-50/80">
                <tr>
                    <th scope="col" class="px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-slate-400">–°—Ç–∞—Ç—É—Å</th>
                    <th scope="col" class="px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-slate-400">–ó–º—ñ–Ω–∏–≤</th>
                    <th scope="col" class="px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-slate-400">–ß–∞—Å</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-slate-100 bg-white">
                {% for status in order.status_history %}
                <tr>
                    <td class="whitespace-nowrap px-4 py-2 text-sm text-slate-900">{{ status.new_status_display }}</td>
                    <td class="whitespace-nowrap px-4 py-2 text-sm text-slate-700">{{ status.changed_by }}</td>
                    <td class="whitespace-nowrap px-4 py-2 text-sm text-slate-500">{{ status.changed_at|date:"d.m.Y H:i" }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="3" class="px-4 py-6 text-center text-sm text-slate-500">–Ü—Å—Ç–æ—Ä—ñ—ó —Å—Ç–∞—Ç—É—Å—ñ–≤ —â–µ –Ω–µ–º–∞—î.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="mt-4">
    <a href="{% url 'orders_active' %}" class="link-back">&larr; –ù–∞–∑–∞–¥ –¥–æ —Ä–æ–±–æ—Ç–∏</a>
</div>

{% endblock %}
