# Рефакторинг: Етап 3 (2026-02-07)

## Ціль етапу
Формалізувати доменні правила статусів та додати інтеграційні тести з ORM для сервісів.

## План етапу
1. Ввести доменний модуль статусів і валідацію в сервісах.
2. Узгодити статуси між доменом і моделями.
3. Додати інтеграційні тести, що працюють з ORM.

## Реалізація (виконано)
- Додано доменний модуль статусів:
  - `orders/domain/status.py`.
- Валідація статусів у `OrderService`:
  - `orders/application/order_service.py`.
- Узгоджено статуси в моделях:
  - `orders/models.py` використовує доменні константи.
- Додані інтеграційні тести з ORM:
  - `orders/tests.py` (клас `OrderServiceIntegrationTests`).

## Поточний стан
- Статуси визначені в домені й узгоджені з persistence‑рівнем.
- Сервіс відкидає невідомі статуси.
- Є базові інтеграційні тести на створення і завершення замовлень.

## Наступні кроки
- Формалізувати правила переходів між статусами (за потреби).
- Перевести відкладені нотифікації у management command.
- Розглянути `Order.current_status` як оптимізацію читання.
